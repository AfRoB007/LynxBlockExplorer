<!-- ***** Wellcome Area Start ***** -->
<section class="block-explorer-wrapper bg-bottom-center" id="welcome-1">
	<div class="block-explorer text">
		<div class="container text-center">
			<div class="row">
				<div class="col-lg-12 align-self-center">
					<h1>Blockchain Explorer</h1>
				</div>
				<div class="offset-lg-3 col-lg-6">
					<p>Up To Block {{coin.General.BlockNumber}}</p>
				</div>
			</div>
		</div>
	</div>
	<div class="search">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="input-wrapper">
						<div class="input">
							<input type="text" placeholder="block, hash, transaction, etc...">
							<button><i class="fa fa-search"></i></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>	
</section>
<!-- ***** Wellcome Area End ***** -->

<section class="block-explorer-section section bg-bottom">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="center-heading">
					<h2 class="section-title">Latest Blocks</h2>
				</div>
			</div>
			<div class="offset-lg-3 col-lg-6">
				<div class="center-text">
					<p>Fusce placerat pretium mauris, vel sollicitudin elit lacinia vitae. Quisque sit amet nisi erat.</p>
				</div>					
			</div>
		</div>			
		<div class="row">
			<div class="col-lg-12">
				<div class="table-responsive">
					<table class="table table-striped table-latests">
						<thead>
							<tr>
								<td>Block Height</td>
								<td>Age</td>
								<td>Transactions</td>
								<td>Value Out</td>
								<td>Difficulty</td>
								<td>Extracted by</td>
							</tr>
						</thead>
						<tbody>							
							<tr>
								<td class="text-center" colspan="6">Loading ...</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</section>


<!-- ***** Contact & Footer Start ***** -->
<footer id="contact">
	<div class="footer-bottom slim">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<p class="copyright">2018 Â© Lynx - Core Development</p>
				</div>
			</div>
		</div>
	</div>
</footer>
<!-- ***** Contact & Footer End ***** -->
<script type="text/javascript">
	$(function(){
		function LatestTransactionsTable(){
			this.data = [];
			this.load = function(){
				let _this = this;
				$.ajax({
					url:'/explorer/latest-transactions',
					type:'GET'		
				}).done(function(result){
					_this.data = result;
					_this.render();
				});

			}
			this.render = function(){
				let _this = this;
				let table = $('.table-latests tbody');
				let rows = '';
				this.data.latestTxns.forEach(function(p){
					let blockUrl = '/latest-blocks/block/'+p.blockhash;
					let row = '<tr>';
					row += '<td><a href="'+blockUrl+'">'+p.blockindex+'</a></td>';
					row += '<td>'+_this._getTime(p)+'</td>';
					row += '<td></td>';
					row += '<td>'+_this._getValueOut(p)+' LYNX</td>';
					row += '<td>'+_this.data.difficulty+'</td>';
					row += '<td><a href="dark-block-explorer-address-detail.html">'+_this._getExtractedBy(p)+'</a></td>';
					row +='</tr>';
					rows += row;						
				});
				table.html(rows);				
			}
			this._getTime = function(p){
				var date = new Date((p.timestamp) * 1000);
				var seconds = Math.floor((new Date() - date) / 1000);
				var interval = Math.floor(seconds / 31536000);
				if (interval > 1) {
					return interval + " years";
				}
				interval = Math.floor(seconds / 2592000);
				if (interval > 1) {
					return interval + " months";
				}
				interval = Math.floor(seconds / 86400);
				if (interval > 1) {
					return interval + " days";
				}
				interval = Math.floor(seconds / 3600);
				if (interval > 1) {
					return interval + " hours";
				}
				interval = Math.floor(seconds / 60);
				if (interval > 1) {
					return interval + " minutes";
				}
				return Math.floor(seconds) + " seconds";
			}
			this._getValueOut = function(p){				
				return total = (p.total / 100000000).toFixed(8);
			}
			this._getExtractedBy = function(p){
				let extractedBy = '';
				if(p.vout.length>0){
					extractedBy = p.vout[0].addresses;
				}
				return extractedBy;
			}
		}
		var latestTxns = new LatestTransactionsTable();
		latestTxns.load();
		setInterval(function () {     
			latestTxns.load();         
        },60000);
	});
</script>